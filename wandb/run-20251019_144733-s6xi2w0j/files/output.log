Using UEM_DEVICE: cuda:0 and LLM_DEVICE: cuda:0
Checkpoints will be saved to: /root/autodl-tmp/PPPUE/DB-Bio-new/ckpt
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading checkpoint shards: 100%|██████████████████████████████████████████████████████████| 4/4 [00:06<00:00,  1.57s/it]
Loading student model with LoRA...
Loading checkpoint shards: 100%|██████████████████████████████████████████████████████████| 4/4 [00:06<00:00,  1.60s/it]
trainable params: 13,631,488 || all params: 8,043,892,736 || trainable%: 0.16946382115456393
Loaded 1548 samples from /root/autodl-tmp/PPPUE/DB-Bio-new/benchmark/train/train.jsonl
Loaded 388 samples from /root/autodl-tmp/PPPUE/DB-Bio-new/benchmark/train/val.jsonl
Dataset loaded: 1548 training samples and 388 validation samples.
/root/miniconda3/envs/llm/lib/python3.9/site-packages/transformers/utils/generic.py:309: FutureWarning: `torch.utils._pytree._register_pytree_node` is deprecated. Please use `torch.utils._pytree.register_pytree_node` instead.
  _torch_pytree._register_pytree_node(

--- Starting Biography Knowledge Distillation Training with LoRA ---
UEM Learning Rate: 1e-05
LoRA Learning Rate: 0.0001
Training Epoch 1:   0%|                                                                        | 0/1548 [00:00<?, ?it/s]/root/autodl-tmp/PPPUE/DB-Bio-new/train.py:150: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=self.uem.device.type == 'cuda'):
Training Epoch 1: 100%|█████████████████████████████████████████████████████████████| 1548/1548 [19:20<00:00,  1.33it/s]
Validating: 100%|█████████████████████████████████████████████████████████████████████| 388/388 [03:36<00:00,  1.79it/s]
Epoch 1 | Train Loss: 0.378159 | Val Loss: 0.358684
Current LR - UEM: 9.76e-06, LoRA: 9.76e-05
Saved decoupled model components to /root/autodl-tmp/PPPUE/DB-Bio-new/ckpt/best_model
Training Epoch 2: 100%|█████████████████████████████████████████████████████████████| 1548/1548 [19:24<00:00,  1.33it/s]
Validating: 100%|█████████████████████████████████████████████████████████████████████| 388/388 [03:36<00:00,  1.79it/s]
Epoch 2 | Train Loss: 0.290138 | Val Loss: 0.331624
Current LR - UEM: 9.05e-06, LoRA: 9.05e-05
Saved decoupled model components to /root/autodl-tmp/PPPUE/DB-Bio-new/ckpt/best_model
Training Epoch 3: 100%|█████████████████████████████████████████████████████████████| 1548/1548 [19:22<00:00,  1.33it/s]
Validating: 100%|█████████████████████████████████████████████████████████████████████| 388/388 [03:38<00:00,  1.78it/s]
Epoch 3 | Train Loss: 0.244331 | Val Loss: 0.338910
Current LR - UEM: 7.96e-06, LoRA: 7.94e-05
Training Epoch 4:   3%|██                                                             | 51/1548 [00:38<18:56,  1.32it/s]
Traceback (most recent call last):
  File "/root/autodl-tmp/PPPUE/DB-Bio-new/train.py", line 473, in <module>
    main()
  File "/root/autodl-tmp/PPPUE/DB-Bio-new/train.py", line 431, in main
    torch.cuda.empty_cache()
  File "/root/miniconda3/envs/llm/lib/python3.9/site-packages/torch/cuda/memory.py", line 224, in empty_cache
    torch._C._cuda_emptyCache()
KeyboardInterrupt
Traceback (most recent call last):
  File "/root/autodl-tmp/PPPUE/DB-Bio-new/train.py", line 473, in <module>
    main()
  File "/root/autodl-tmp/PPPUE/DB-Bio-new/train.py", line 431, in main
    torch.cuda.empty_cache()
  File "/root/miniconda3/envs/llm/lib/python3.9/site-packages/torch/cuda/memory.py", line 224, in empty_cache
    torch._C._cuda_emptyCache()
KeyboardInterrupt
